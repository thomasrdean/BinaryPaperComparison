
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <title>DnsPacket format specification</title>
  </head>
  <body>
           <div class="container">
  <h1>DnsPacket format specification</h1>

      
<a name='type-dns_packet'></a>
<h1>Type: DnsPacket</h1>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>transaction_id</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>flags</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>qdcount</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>ancount</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>nscount</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>...</td>
<td>arcount</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>queries</td>
<td><a href="#type-dns_packet-query">Query</a></td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>answers</td>
<td><a href="#type-dns_packet-resource_record">ResourceRecord</a></td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>authorities</td>
<td><a href="#type-dns_packet-resource_record">ResourceRecord</a></td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>additionals</td>
<td><a href="#type-dns_packet-resource_record">ResourceRecord</a></td>
<td></td>
</tr>
</table>
<a name='enum-dns_packet-rr_type'></a>
<h2>Enum: rr_type</h2>

<table class="table">
<tr>
<th>ID</th><th>Name</th><th>Note</th>
</tr>
<tr>
<td>1</td><td>a</td><td></td></tr>
</tr>
<tr>
<td>2</td><td>ns</td><td></td></tr>
</tr>
<tr>
<td>5</td><td>cname</td><td></td></tr>
</tr>
<tr>
<td>6</td><td>soa</td><td></td></tr>
</tr>
<tr>
<td>28</td><td>aaaa</td><td></td></tr>
</tr>
<tr>
<td>41</td><td>opt</td><td></td></tr>
</tr>
<tr>
<td>43</td><td>ds</td><td></td></tr>
</tr>
<tr>
<td>46</td><td>rrsig</td><td></td></tr>
</tr>
<tr>
<td>48</td><td>key</td><td></td></tr>
</tr>
<tr>
<td>50</td><td>nsec3</td><td></td></tr>
</tr>
</table>
<a name='type-dns_packet-map_'></a>
<h2>Type: Map</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>map_num</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>...</td>
<td>length</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>map_bits</td>
<td>str(utf-8)</td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-resource_record'></a>
<h2>Type: ResourceRecord</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>name</td>
<td><a href="#type-dns_packet-domain">Domain</a></td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>type</td>
<td>u2be→RrType</td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>body</td>
<td>SwitchType(Name(identifier(type)),Map(EnumByLabel(identifier(rr_type),identifier(a),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_a),None,List()), EnumByLabel(identifier(rr_type),identifier(ds),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_ds),None,List()), EnumByLabel(identifier(rr_type),identifier(ns),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_ns),None,List()), EnumByLabel(identifier(rr_type),identifier(key),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_key),None,List()), EnumByLabel(identifier(rr_type),identifier(cname),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_cname),None,List()), EnumByLabel(identifier(rr_type),identifier(opt),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_opt),None,List()), EnumByLabel(identifier(rr_type),identifier(rrsig),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_rrsig),None,List()), EnumByLabel(identifier(rr_type),identifier(nsec3),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_nsec3),None,List()), EnumByLabel(identifier(rr_type),identifier(aaaa),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_aaaa),None,List()), EnumByLabel(identifier(rr_type),identifier(soa),typeId(false,List(),false)) -> UserTypeInstream(List(rr_body_soa),None,List())),true)</td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_opt'></a>
<h2>Type: RrBodyOpt</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>udp_payload_size</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>higher_bits_in_extended_rcode</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>...</td>
<td>edns0version</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>z</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_key'></a>
<h2>Type: RrBodyKey</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-domain'></a>
<h2>Type: Domain</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>name</td>
<td><a href="#type-dns_packet-word">Word</a></td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-ipv6_address'></a>
<h2>Type: Ipv6Address</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>ip_v6</td>
<td></td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-query'></a>
<h2>Type: Query</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>name</td>
<td><a href="#type-dns_packet-domain">Domain</a></td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>type</td>
<td>u2be→RrType</td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>query_class</td>
<td>u2be</td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_rrsig'></a>
<h2>Type: RrBodyRrsig</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>type_cov</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>...</td>
<td>alg</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>...</td>
<td>labels</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>orig_time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>16</td>
<td>...</td>
<td>sig_exp</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>20</td>
<td>...</td>
<td>sig_inception</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>24</td>
<td>...</td>
<td>key_tag</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>26</td>
<td>...</td>
<td>sign_name</td>
<td><a href="#type-dns_packet-domain">Domain</a></td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>signature</td>
<td>str(utf-8)</td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-ipv4_address'></a>
<h2>Type: Ipv4Address</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>ip</td>
<td></td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_cname'></a>
<h2>Type: RrBodyCname</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>cname</td>
<td><a href="#type-dns_packet-domain">Domain</a></td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_aaaa'></a>
<h2>Type: RrBodyAaaa</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>address</td>
<td><a href="#type-dns_packet-ipv6_address">Ipv6Address</a></td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_ns'></a>
<h2>Type: RrBodyNs</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>name_server</td>
<td><a href="#type-dns_packet-domain">Domain</a></td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_ds'></a>
<h2>Type: RrBodyDs</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>keyid</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>...</td>
<td>alg</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>...</td>
<td>digest_type</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>digest</td>
<td>str(utf-8)</td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_nsec3'></a>
<h2>Type: RrBodyNsec3</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>alg</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>...</td>
<td>flags</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>...</td>
<td>iterations</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>salt_length</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>13</td>
<td>...</td>
<td>hash_length</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>14</td>
<td>...</td>
<td>next_hash</td>
<td>str(utf-8)</td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>type_map</td>
<td><a href="#type-dns_packet-map_">Map</a></td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-rr_body_a'></a>
<h2>Type: RrBodyA</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>address</td>
<td><a href="#type-dns_packet-ipv4_address">Ipv4Address</a></td>
<td></td>
</tr>
</table>
<a name='type-dns_packet-word'></a>
<h2>Type: Word</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>length</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>...</td>
<td>ref</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>letters</td>
<td>str(utf-8)</td>
<td></td>
</tr>
</table>
value instance: ValueInstanceSpec(List(types, word, instances, is_ref),DocSpec(None,List()),Compare(Name(identifier(length)),Eq,IntNum(192)),None,Some(CalcBooleanType))
<a name='type-dns_packet-rr_body_soa'></a>
<h2>Type: RrBodySoa</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>class_</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>time_to_live</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>data_length</td>
<td>u2be</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>primary_name_server</td>
<td><a href="#type-dns_packet-domain">Domain</a></td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>reponsible_authority</td>
<td><a href="#type-dns_packet-domain">Domain</a></td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>serial_number</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>refresh_interval</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>retry_interval</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>expire_limit</td>
<td>u4be</td>
<td></td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>minimum_ttl</td>
<td>u4be</td>
<td></td>
</tr>
</table>

  </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  </body>
</html>
      
